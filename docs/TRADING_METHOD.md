# 알파 사이클 (Alpha Cycle) 매매법

## 개요

알파 사이클은 레버리지 ETF(TQQQ, SOXL 등)를 대상으로 한 **기계적 분할 매수/매도 전략**입니다.
핵심 철학은 **"현금 80%를 끝까지 활용한다"**는 것으로, 하락장에서도 현금이 바닥나지 않도록 설계되었습니다.

> 📱 앱 설계 문서: [APP_DESIGN.md](./APP_DESIGN.md)

---

## 핵심 원칙

```
┌─────────────────────────────────────────────────────────────────┐
│  1. 초기 진입: 시드의 20%만 투입 (80%는 현금 보유)                  │
│  2. 손실률 기준: 초기 진입가 대비 (추가 매수해도 변하지 않음)         │
│  3. 익절 기준: 평균단가 대비 +20% (추가 매수하면 개선됨)             │
│  4. 가중 매수: 손실률 -20% 이하일 때 매일 매수                      │
│  5. 승부수: -50% 도달 시 1회 대량 매수                             │
└─────────────────────────────────────────────────────────────────┘
```

---

## 상세 규칙

### 1단계: 초기 설정

| 항목 | 계산 | 예시 (1억 시드) | 예시 (5천만 시드) |
|------|------|----------------|------------------|
| 총 시드 | 사용자 입력 | 100,000,000원 | 50,000,000원 |
| 초기 진입금 (20%) | 시드 × 0.20 | 20,000,000원 | 10,000,000원 |
| 잔여 현금 (80%) | 시드 × 0.80 | 80,000,000원 | 40,000,000원 |

### 2단계: 초기 진입

- **시드의 20%**로 첫 매수
- 이때의 매수가가 **초기 진입가** (손실률 기준점)
- 예: TQQQ $100에 2,000만원어치 매수 → 초기 진입가 = $100

### 3단계: 손실률 계산 (핵심!)

```
손실률 = (현재가 - 초기진입가) ÷ 초기진입가 × 100

★ 중요: 추가 매수를 해도 초기진입가는 변하지 않음!
```

| 초기진입가 | 현재가 | 손실률 |
|-----------|--------|--------|
| $100 | $80 | -20% |
| $100 | $78 | -22% |
| $100 | $50 | -50% |
| $100 | $120 | +20% |

### 4단계: 가중 매수 (손실률 -20% 이하일 때)

**조건**: 손실률이 -20% 이하일 때 **매일** 매수

**공식**:
```
매수액 = 초기진입금 × |손실률| ÷ 1000
```

**예시 (1억 시드, 초기진입금 2,000만원)**:

| 손실률 | 계산 | 매수액 |
|--------|------|--------|
| -20% | 2000만 × 20 ÷ 1000 | 40만원 |
| -22% | 2000만 × 22 ÷ 1000 | 44만원 |
| -25% | 2000만 × 25 ÷ 1000 | 50만원 |
| -30% | 2000만 × 30 ÷ 1000 | 60만원 |
| -40% | 2000만 × 40 ÷ 1000 | 80만원 |
| -50% | 2000만 × 50 ÷ 1000 | 100만원 |

**예시 (5천만 시드, 초기진입금 1,000만원)**:

| 손실률 | 계산 | 매수액 |
|--------|------|--------|
| -20% | 1000만 × 20 ÷ 1000 | 20만원 |
| -22% | 1000만 × 22 ÷ 1000 | 22만원 |
| -30% | 1000만 × 30 ÷ 1000 | 30만원 |
| -50% | 1000만 × 50 ÷ 1000 | 50만원 |

**매수 정지 조건**: 손실률이 -20% 미만일 때 (예: -18%, -15%)

### 5단계: 승부수 (-50% 도달 시)

**조건**: 손실률이 -50% 이하일 때 **1회만** 발동

**공식**:
```
승부수 매수액 = 초기진입금 × 50%
```

| 시드 | 초기진입금 | 승부수 매수액 |
|------|-----------|--------------|
| 1억원 | 2,000만원 | 1,000만원 |
| 5천만원 | 1,000만원 | 500만원 |

**중요**: 승부수 날에도 가중 매수는 같이 실행!
```
예: -50% 날
→ 승부수: 1,000만원
→ 가중매수: 100만원 (2000만 × 50 ÷ 1000)
→ 총 매수: 1,100만원
```

### 6단계: 익절 (평균단가 대비 +20%)

**조건**: 평균단가 대비 수익률이 +20% 이상

```
수익률 = (현재가 - 평균단가) ÷ 평균단가 × 100

★ 중요: 추가 매수하면 평균단가가 낮아져서 익절이 빨라짐!
```

**익절 시**:
1. 전량 매도
2. 매도금 + 잔여 현금 = 새 시드
3. 새 사이클 시작 (1단계로 돌아감)

---

## 시뮬레이션 예시

### 시나리오: 5,000만원 시드, TQQQ $100 시작

```
Day 1:  초기 진입 → 1,000만원 투입 ($100) ✅
        초기진입가: $100

Day 5:  현재가 $80 → 손실률 -20%
        → 20만원 매수 ✅

Day 6:  현재가 $82 → 손실률 -18%
        → 매수 정지 ⏸️ (-20% 미만)

Day 7:  현재가 $78 → 손실률 -22%
        → 22만원 매수 ✅

Day 10: 현재가 $70 → 손실률 -30%
        → 30만원 매수 ✅

Day 15: 현재가 $50 → 손실률 -50%
        → 승부수 500만원 🔴
        → 가중매수 50만원 ✅
        → 총 550만원 매수

Day 16: 현재가 $49 → 손실률 -51%
        → 51만원 매수 ✅ (승부수는 이미 사용)

Day 30: 현재가가 평균단가 대비 +20% 도달
        → 전량 매도 💰
        → 새 사이클 시작
```

---

## 손실률 vs 수익률 차이

```
┌─────────────────────────────────────────────────────────────────┐
│  손실률 (Loss from Entry)                                        │
│  ─────────────────────────                                      │
│  • 기준: 초기 진입가 (고정)                                        │
│  • 용도: 가중 매수, 승부수 조건 판단                                │
│  • 특징: 추가 매수해도 변하지 않음                                  │
├─────────────────────────────────────────────────────────────────┤
│  수익률 (Return from Average)                                    │
│  ───────────────────────────                                    │
│  • 기준: 평균 단가 (변동)                                         │
│  • 용도: 익절 조건 판단                                           │
│  • 특징: 추가 매수하면 평균단가가 낮아져서 익절이 빨라짐              │
└─────────────────────────────────────────────────────────────────┘
```

**예시**:
```
초기 진입: $100에 1,000만원 매수 → 평균단가 $100
추가 매수: $50에 500만원 매수 → 평균단가 약 $75로 하락

현재가 $60일 때:
• 손실률 (진입가 기준): ($60-$100)/$100 = -40%
• 수익률 (평균단가 기준): ($60-$75)/$75 = -20%

현재가 $90일 때:
• 손실률 (진입가 기준): ($90-$100)/$100 = -10%
• 수익률 (평균단가 기준): ($90-$75)/$75 = +20% → 익절!
```

---

## 왜 이 전략이 효과적인가?

### 1. 현금 보존
- 초기 20%만 투입하여 80%는 하락 대비용으로 보유
- 시드 규모에 비례한 매수액으로 현금이 바닥나지 않음

### 2. 가중 매수의 효과
- 손실이 클수록 많이 매수 → 평균단가 효과적으로 낮춤
- 하락장에서 공포 매도 대신 기계적 매수

### 3. 평균단가 기준 익절
- 추가 매수할수록 익절 목표가 낮아짐
- 큰 반등 없이도 익절 가능

### 4. 승부수의 역할
- 극단적 하락(-50%) 시 대량 매수로 평균단가 급격히 하락
- 작은 반등만으로도 익절 가능해짐

---

## 파라미터 조정 가이드

| 파라미터 | 기본값 | 공격적 | 보수적 |
|---------|--------|--------|--------|
| 초기 진입 비율 | 20% | 25% | 15% |
| 매수 시작점 | -20% | -15% | -25% |
| 익절 목표 | +20% | +15% | +25% |
| 승부수 발동점 | -50% | -40% | -60% |

---

## 주의사항

1. **레버리지 ETF 특성**: 장기 하락장에서 원금 회복이 어려울 수 있음
2. **환율 리스크**: 달러 투자이므로 환율 변동 고려 필요
3. **기계적 실행**: 감정 개입 없이 규칙대로 실행해야 효과적
4. **백테스팅 필수**: 실제 투자 전 충분한 백테스팅으로 검증

---

## 앱 구현 현황

알파 사이클 매매법의 모든 핵심 로직이 Flutter 앱에 구현 완료되었습니다.

### 구현 완료 항목
- [x] 초기 진입 (시드 20%) 자동 계산
- [x] 손실률 계산 (초기 진입가 기준, 고정)
- [x] 수익률 계산 (평균 단가 기준, 변동)
- [x] 가중 매수 금액 자동 계산 (초기진입금 × |손실률| ÷ 1000)
- [x] 승부수 발동 (초기진입금 × 50%, 사이클당 1회)
- [x] 익절 조건 판단 (평균단가 대비 +20%)
- [x] 매수 신호 알림 시스템
- [x] 사이클 관리 (시작 → 진행 → 완료)
- [x] 거래 내역 기록 및 통계
- [x] 일반 보유 종목 관리 (비사이클)

### 검증 완료
- 34개 단위 테스트 통과 (calculators_test.dart, signal_detector_test.dart)
- Playwright MCP를 통한 E2E 검증 완료

### 앱 내 관련 화면
| 화면 | 경로 | 매매법 적용 |
|------|------|-----------|
| 종목 관리 | /stocks | 활성 사이클 목록, 포트폴리오 요약 |
| 사이클 설정 | /stocks/setup | 시드 금액, 매매 조건 설정 |
| 사이클 상세 | /stocks/detail | 손익 게이지, 매수 신호, 거래 이력 |
| 거래 내역 | /history | 거래 기록, 완료된 사이클 통계 |
| 설정 | /settings | 기본 매매 조건 (매수 -20%, 익절 +20%) |

---

## 버전 히스토리

- **v2.2** (2026-02-16): 문서 검증 및 현행화 (다크모드, ReturnBadge, 거래내역 리뉴얼 반영)
- **v2.1** (2026-02-12): 문서 검증 및 현행화 (앱 구현 상태와 일치 확인)
- **v2.0** (2025-01-29): 손실률 기준을 평균단가 → 초기진입가로 변경
- **v1.0**: 초기 버전 (평균단가 기준)
