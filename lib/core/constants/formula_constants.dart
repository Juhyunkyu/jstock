/// 알파 사이클 매매법 공식 상수
///
/// ⚠️ 중요: 이 파일의 상수는 매매법의 핵심입니다.
/// 수정 시 PROJECT_PLAN.md의 공식과 일치하는지 반드시 확인하세요.
class FormulaConstants {
  FormulaConstants._();

  // ═══════════════════════════════════════════════════════════════
  // 초기 설정 공식
  // ═══════════════════════════════════════════════════════════════

  /// 초기 진입 비율: 시드의 20%
  /// 공식: 초기 진입금 = 시드 × 0.20
  static const double initialEntryRatio = 0.20;

  /// 잔여 현금 비율: 시드의 80% (초기 진입 후)
  ///
  /// ⚠️ 참고용 상수: 실제 remainingCash는 시드(100%)로 시작하고
  /// 초기 진입(20%) 후 80%가 됨. 매수할 때마다 차감됨.
  ///
  /// 공식: 초기진입 후 잔여현금 = 시드 - 초기진입금 = 시드 × 0.80
  static const double remainingCashRatio = 0.80;

  // ═══════════════════════════════════════════════════════════════
  // 손실률 기반 매수 조건
  // ═══════════════════════════════════════════════════════════════

  /// 가중 매수 시작점: -20%
  /// 조건: 손실률 <= -20% 일 때 매일 매수
  static const double buyTriggerPercent = -20.0;

  /// 승부수 발동점: -50%
  /// 조건: 손실률 <= -50% 일 때 1회만 발동
  static const double panicTriggerPercent = -50.0;

  // ═══════════════════════════════════════════════════════════════
  // 가중 매수 공식
  // ═══════════════════════════════════════════════════════════════

  /// 가중 매수 나눗수: 1000
  /// 공식: 가중 매수 금액 = 초기진입금 × |손실률| ÷ 1000
  ///
  /// 예시 (시드 1억, 초기진입금 2,000만원):
  /// - 손실률 -20%: 2,000만 × 20 ÷ 1000 = 40만원
  /// - 손실률 -25%: 2,000만 × 25 ÷ 1000 = 50만원
  /// - 손실률 -30%: 2,000만 × 30 ÷ 1000 = 60만원
  /// - 손실률 -50%: 2,000만 × 50 ÷ 1000 = 100만원
  static const double weightedBuyDivisor = 1000.0;

  // ═══════════════════════════════════════════════════════════════
  // 승부수 공식
  // ═══════════════════════════════════════════════════════════════

  /// 승부수 비율: 초기진입금의 50%
  /// 공식: 승부수 금액 = 초기진입금 × 0.50
  ///
  /// 예시:
  /// - 시드 1억 (초기진입금 2,000만원): 승부수 = 1,000만원
  /// - 시드 5,000만원 (초기진입금 1,000만원): 승부수 = 500만원
  static const double panicBuyRatio = 0.50;

  // ═══════════════════════════════════════════════════════════════
  // 익절 조건
  // ═══════════════════════════════════════════════════════════════

  /// 익절 목표 수익률: +20%
  /// 조건: 수익률(평균단가 기준) >= +20% 일 때 전량 매도
  static const double sellTriggerPercent = 20.0;

  // ═══════════════════════════════════════════════════════════════
  // 공식 요약 (주석용)
  // ═══════════════════════════════════════════════════════════════
  //
  // 【손실률 계산】 - 초기 진입가 기준 (고정)
  // 손실률(%) = (현재가 - 초기진입가) ÷ 초기진입가 × 100
  //
  // 【수익률 계산】 - 평균 단가 기준 (변동)
  // 수익률(%) = (현재가 - 평균단가) ÷ 평균단가 × 100
  //
  // 【가중 매수】 - 손실률 <= -20% 일 때 매일
  // 매수 금액 = 초기진입금 × |손실률| ÷ 1000
  //
  // 【승부수】 - 손실률 <= -50% 일 때 1회만
  // 승부수 금액 = 초기진입금 × 0.50
  // ★ 승부수 날에도 가중 매수 함께 실행!
  //
  // 【익절】 - 수익률 >= +20% 일 때
  // 전량 매도 → 새 사이클 시작
  // ═══════════════════════════════════════════════════════════════
}
